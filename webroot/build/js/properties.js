(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{344:function(t,e,a){"use strict";var i=a(91);a.n(i).a},346:function(t,e,a){"use strict";var i=a(92);a.n(i).a},348:function(t,e,a){"use strict";var i=a(93);a.n(i).a},350:function(t,e,a){"use strict";var i=a(94);a.n(i).a},352:function(t,e,a){"use strict";var i=a(95);a.n(i).a},354:function(t,e,a){},559:function(t,e,a){"use strict";a.r(e);var i,n,s,o=a(57),r=a(321),l=a(21),c=a(19),u=a(45),d=a.n(u),f=a(37),v="LOAD_PROPERTIES",m="SELECT_PROPERTY",p="LOAD_VALUES",h="ADD_VALUE",b="UPDATE_VALUE",_="DELETE_VALUE",g="SELECT_VALUE",V="UPDATE_SELECTED_VALUE",E="SET_FILTER",C="SET_SHOW_SEARCH",w="SET_EDIT_MODE",y="TOGGLE_FILTER_VALUE",O="SET_LOADING",L=a(26),A=a.n(L),S=a(46),j=a.n(S),T=new o.a,x=function(){return new Promise(function(n,s){A.a.get("commonList").then(function(t){var e=t.data,a=t.status,i=t.statusText;200==a?n(e):(T.$emit("error_dialog",null,"Error during getting parameters"),s(i))}).catch(function(t){T.$emit("error_dialog",null,t),s(t)})})},I=function(t){return new Promise(function(n,s){A.a.get("valuesList/"+t).then(function(t){var e=t.data,a=t.status,i=t.statusText;200==a?n(e):(T.$emit("error_dialog",null,"Error during getting values"),s(i))}).catch(function(t){T.$emit("error_dialog",null,t),s(t)})})},k=function(t,e){return new Promise(function(n,s){A.a.create({headers:{"X-Requested-With":"XMLHttpRequest"}}).post("editValue/"+t,j.a.stringify(e)).then(function(t){var e=t.data,a=t.status,i=t.statusText;200==a?n(e):(T.$emit("error_dialog",null,"Error during saving value"),s(i))}).catch(function(t){T.$emit("error_dialog",null,t),s(t)})})},P=function(t){var e=new Promise(function(n,s){T.$emit("confirm_dialog","Attention","Are you sure want to delete selected value?",function(){return A.a.create({headers:{"X-Requested-With":"XMLHttpRequest"}}).delete("deleteValue/"+t.id).then(function(t){var e=t.data,a=t.status,i=t.statusText;200==a?n(e):(T.$emit("error_dialog",null,"Error during removing value"),s(i))}).catch(function(t){T.$emit("error_dialog",null,t),s(t)}),e},function(){s()})});return e},D={namespaced:!0,state:{properties:[]},mutations:Object(c.a)({},v,function(t,e){var a=e.properties;t.properties=a}),getters:{allProperties:function(t){return t.properties}},actions:{getAllProperties:function(t){var i=t.commit;return new Promise(function(e,a){x().then(function(t){i(v,{properties:t}),e(t)},function(t){a(t)})})}}},N={namespaced:!0,state:{values:[]},mutations:(i={},Object(c.a)(i,p,function(t,e){var a=e.values;t.values=a}),Object(c.a)(i,b,function(t,e){var a=e.idx,i=e.value;d.a.extend(t.values[a],i)}),Object(c.a)(i,h,function(t,e){var a=e.value;t.values.push(a)}),Object(c.a)(i,_,function(t,e){var a=e.value,i=d.a.findIndex(t.values,a);t.values.splice(i,1)}),i),getters:{allValues:function(t,e,a){return t.values.filter(function(t){return!(!a.editor.showSearch&&!a.editor.editMode||a.editor.filterValues&&t.used||a.editor.filterValue&&!(-1<t.name.toLowerCase().indexOf(a.editor.filterValue.toLowerCase())))}).sort(function(t,e){return t.name.localeCompare(e.name)})},valuesCount:function(t){return t.values.length}},actions:{getAllValues:function(t,e){var a=t.commit,i=t.dispatch,n=e.propertyId;return i("setLoading",!0,{root:!0}),new Promise(function(e,t){I(n).then(function(t){i("setLoading",!1,{root:!0}),a(p,{values:t}),e(t)},function(){i("setLoading",!1),t()})})},update:function(t,e){var a=t.commit,i=t.state,n=d.a.findIndex(i.values,e);n<0?a(h,{value:e}):a(b,{idx:n,value:e})},delete:function(t,e){var a=t.commit;t.state;a(_,{value:e})}}},R={namespaced:!1,state:{filterValue:"",showSearch:!0,editMode:!1,filterValues:!1},mutations:(n={},Object(c.a)(n,E,function(t,e){t.filterValue=e}),Object(c.a)(n,C,function(t,e){t.showSearch=e}),Object(c.a)(n,w,function(t,e){t.editMode=e}),Object(c.a)(n,y,function(t){t.filterValues=!t.filterValues}),n),getters:{isAllowEdit:function(t,e,a){return!!a.selectedValue.id&&1==e["values/allValues"].filter(function(t){return t.id==a.selectedValue.id}).length}},actions:{onAddItem:function(t){var e=t.commit,a=(t.dispatch,t.rootState);e(w,!1),e(C,!1),e(g,Object(l.a)({},a.emptyValue))},onEditItem:function(t){var e=t.commit;t.dispatch,t.rootState;e(w,!0),e(C,!1)},onReset:function(t,e){var a=t.commit,i=(t.dispatch,t.rootState,e.selected);a(w,!1),a(C,!0),a(V,i)},resetValues:function(t){var e=t.commit,a=(t.dispatch,t.rootState);e(C,!0),e(g,Object(l.a)({},a.emptyValue)),e(E,"")},onSelectedUpdate:function(t,e){var a=t.commit,i=(t.state,t.rootState,e.selected);a(V,i)},saveValue:function(t){t.commit;var i=t.dispatch,n=(t.state,t.rootState);return new Promise(function(e,a){i("setLoading",!0),k(n.selectedItem,n.selectedValue).then(function(t){i("setLoading",!1),i("resetValues"),i("values/update",t),e(t)},function(t){i("setLoading",!1),i("resetValues"),a(t)})})},deleteValue:function(t){t.commit;var i=t.dispatch,n=(t.state,t.rootState);return i("setLoading",!0),new Promise(function(e,a){P(n.selectedValue).then(function(t){i("setLoading",!1),i("resetValues"),i("values/delete",t),e(t)},function(t){i("setLoading",!1),i("resetValues"),a(t)})})},onFilterValues:function(t){(0,t.commit)(y)}}};o.a.use(f.a);var U=(s={},Object(c.a)(s,m,function(t,e){t.selectedItem=e}),Object(c.a)(s,g,function(t,e){t.selectedValue=e}),Object(c.a)(s,V,function(t,e){t.selectedValue=d.a.extend(t.selectedValue,e)}),Object(c.a)(s,O,function(t,e){t.isLoading=e}),s),B={selectValue:function(t,e){var a=t.commit,i=t.state,n=Object(l.a)({},i.emptyValue);if(i.editor.showSearch){if(e){var s=i.values.values.filter(function(t){return e==t.id});n=Object(r.a)(s,1)[0]}1!=n.used&&a(g,n)}},setLoading:function(t,e){var a=t.commit;t.state;a(O,e)}},F={id:null,name:"",used:null},M=new f.a.Store({strict:!1,modules:{properties:D,values:N,editor:R},state:{emptyValue:F,selectedItem:0,selectedValue:F,isLoading:!1},mutations:U,actions:B,getters:{}}),q=a(11),H=a(9),X=new(function(){function t(){Object(q.a)(this,t)}return Object(H.a)(t,[{key:"fireEvent",value:function(t,e){if(document.createEventObject){var a=document.createEventObject();t.fireEvent("on".concat(e),a)}else{if(!document.createEvent)return!1;var i=document.createEvent("HTMLEvents");i.initEvent(e,!1,!1),t.dispatchEvent(i)}}},{key:"addListener",value:function(t,e,a){t.addEventListener?t.addEventListener(e,a,!1):t.attachEvent("on".concat(e),a)}},{key:"removeListener",value:function(t,e,a){t.removeEventListener?t.removeEventListener(e,a,!1):t.detachEvent("on".concat(e),a)}}]),t}()),G={name:"properties-list",directives:{selectpicker:{name:"selectpicker",bind:function(e,a){$(e).selectpicker("destroy"),setTimeout(function(){var t=e.value;$(e).selectpicker(a.value),$(e).selectpicker("render"),$(e).selectpicker("val",t)},0),$(e).on("changed.bs.select",function(){X.fireEvent(e,"change")})},componentUpdated:function(t,e){$(t).selectpicker("refresh")},unbind:function(t){$(t).selectpicker("destroy")}}},data:function(){return{selectOptions:{container:"body",liveSearch:!0,title:"Select property"},selectedItem:0}},created:function(){this.$store.dispatch("properties/getAllProperties")},computed:Object(l.a)({},Object(f.b)({items:"properties/allProperties"})),methods:{onValueChange:function(){this.$emit("select",this.selectedItem)}}},W=(a(344),a(42)),J=Object(W.a)(G,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("select",{directives:[{name:"model",rawName:"v-model",value:a.selectedItem,expression:"selectedItem"},{name:"selectpicker",rawName:"v-selectpicker",value:a.selectOptions,expression:"selectOptions"}],staticClass:"dropup",on:{change:[function(t){var e=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});a.selectedItem=t.target.multiple?e:e[0]},a.onValueChange]}},a._l(a.items,function(t,e){return i("option",{key:e,domProps:{value:t.id}},[a._v(a._s(t.name))])}))},[],!1,null,"37176270",null);J.options.__file="PropertiesList.vue";var K=J.exports,Y={name:"value-editor",data:function(){return{selected:{}}},computed:Object(l.a)({filterValue:Object(l.a)({},Object(f.c)({get:function(t){return t.editor.filterValue}}),{set:function(t){this.$store.commit(E,t)}}),selectedValueName:{get:function(){return this.$store.state.selectedValue.name},set:function(t){var e=Object(l.a)({},this.$store.state.selectedValue);e.name=t,this.$store.dispatch("onSelectedUpdate",{selected:e})}}},Object(f.b)({isAllowEdit:"isAllowEdit"}),Object(f.c)({showSearch:function(t){return t.editor.showSearch},filterValues:function(t){return t.editor.filterValues}}),{filterTooltip:function(){return this.filterValues?"Show all values":"Filter used values"}}),methods:{addItem:function(){this.selected=Object(l.a)({},this.$store.state.selectedValue),this.$store.dispatch("onAddItem")},onEditItem:function(){this.selected=Object(l.a)({},this.$store.state.selectedValue),this.$store.dispatch("onEditItem")},saveItem:function(){this.$store.dispatch("saveValue")},deleteItem:function(){this.$store.dispatch("deleteValue")},reset:function(){this.$store.dispatch("onReset",{selected:this.selected})},onFilterClick:function(){this.$store.dispatch("onFilterValues")}}},z=(a(346),Object(W.a)(Y,function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{},[a("div",{directives:[{name:"show",rawName:"v-show",value:e.showSearch,expression:"showSearch"}],staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.filterValue,expression:"filterValue"}],staticClass:"form-control",attrs:{type:"text",placeholder:"Search..."},domProps:{value:e.filterValue},on:{input:function(t){t.target.composing||(e.filterValue=t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-btn"},[a("button",{staticClass:"fa2 fa-filter btn btn-default",class:{active:e.filterValues},attrs:{type:"button","data-toggle":"tooltip",title:e.filterTooltip,"data-original-title":e.filterTooltip},on:{click:function(t){return t.preventDefault(),e.onFilterClick(t)}}}),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:e.isAllowEdit,expression:"isAllowEdit"}],staticClass:"fa2 fa-pencil-square-o btn btn-default",attrs:{type:"button","data-toggle":"tooltip",title:"Edit selected value"},on:{click:function(t){return t.preventDefault(),e.onEditItem(t)}}}),e._v(" "),a("button",{directives:[{name:"show",rawName:"v-show",value:e.isAllowEdit,expression:"isAllowEdit"}],staticClass:"fa2 fa-trash-o btn btn-default",attrs:{type:"button","data-toggle":"tooltip",title:"Remove selected value"},on:{click:function(t){return t.preventDefault(),e.deleteItem(t)}}}),e._v(" "),a("button",{staticClass:"fa2 fa-plus btn btn-default",on:{click:function(t){return t.preventDefault(),e.addItem(t)}}},[a("span",{staticStyle:{"margin-left":"5px"}},[e._v("New")])])])]),e._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:!e.showSearch,expression:"!showSearch"}],staticClass:"input-group"},[a("input",{directives:[{name:"model",rawName:"v-model",value:e.selectedValueName,expression:"selectedValueName"}],staticClass:"form-control",attrs:{type:"text",placeholder:""},domProps:{value:e.selectedValueName},on:{input:function(t){t.target.composing||(e.selectedValueName=t.target.value)}}}),e._v(" "),a("div",{staticClass:"input-group-btn"},[a("button",{staticClass:"fa2 fa-floppy-o btn btn-default",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.saveItem(t)}}},[a("span",{staticStyle:{"margin-left":"5px"}},[e._v("Save")])]),e._v(" "),a("button",{staticClass:"fa2 fa-undo btn btn-default",attrs:{type:"button"},on:{click:function(t){return t.preventDefault(),e.reset(t)}}},[a("span",{staticStyle:{"margin-left":"5px"}},[e._v("Cancel")])])])])])},[],!1,null,"26854548",null));z.options.__file="ValueEditor.vue";var Q={name:"values-list",components:{ValueEditor:z.exports},props:{property:{default:0}},data:function(){return{}},computed:Object(l.a)({},Object(f.b)({items:"values/allValues",valuesCount:"values/valuesCount"}),Object(f.c)({selectedValue:"selectedValue",isLoading:"isLoading"})),methods:{onSelectItem:function(t){this.$store.dispatch("selectValue",t)},isActive:function(t){var e=this.$store.state.selectedValue;return{active:!(!e||!t.id)&&e.id==t.id,disabled:t.used}}},watch:{property:function(t){this.$store.commit(m,t),this.$store.dispatch("resetValues"),this.$store.dispatch("values/getAllValues",{propertyId:t})}}},Z=(a(348),Object(W.a)(Q,function(){var a=this,t=a.$createElement,i=a._self._c||t;return i("div",{staticClass:"values-list-wrapper"},[i("value-editor",{directives:[{name:"show",rawName:"v-show",value:a.valuesCount,expression:"valuesCount"}],staticClass:"propertyEditor"}),a._v(" "),i("div",{staticClass:"list-group list"},a._l(a.items,function(e){return i("a",{key:e.id,staticClass:"list-group-item",class:a.isActive(e),attrs:{href:"#"},on:{click:function(t){t.preventDefault(),a.onSelectItem(e.id)}}},[a._v(a._s(e.name))])})),a._v(" "),i("div",{directives:[{name:"show",rawName:"v-show",value:a.isLoading,expression:"isLoading"}],staticClass:"values-list-wrapper__loader"})],1)},[],!1,null,"cf59beac",null));Z.options.__file="ValuesList.vue";var tt=Z.exports,et={name:"vi-analysis-filter",props:["confirmid","errorid"],data:function(){return{confirmationTitle:"Title",confirmationBody:"Body",errorTitle:"Error",errorBody:"An error occured. Try again."}},mounted:function(){var n=this,s=this.confirmid,a=this.errorid;T.$on(s,function(t,e,a,i){t&&e&&a&&(n.confirmationTitle=t||"Title",n.confirmationBody=e||"Body",n.confirmationAction=a||{},n.confirmationCloseAction=i||{},$("#"+s).modal("show"))}),T.$on(a,function(t,e){t&&e&&action&&(n.errorTitle=t||"Error",n.errorBody=e||"An error occured. Try again.",$("#"+a).modal("show"))})},methods:{confirmAction:function(){var t=this.confirmid;$("#"+t).modal("hide"),"function"==typeof this.confirmationAction&&this.confirmationAction()},confirmCloseAction:function(){"function"==typeof this.confirmationCloseAction&&this.confirmationCloseAction()}}},at=(a(350),Object(W.a)(et,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[t._t("default"),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:t.confirmid,tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:t.confirmCloseAction}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v(t._s(t.confirmationTitle))])]),t._v(" "),a("div",{staticClass:"modal-body"},[a("p",[t._v(t._s(t.confirmationBody))])]),t._v(" "),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"},on:{click:t.confirmCloseAction}},[t._v("Close")]),t._v(" "),a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:t.confirmAction}},[t._v("OK")])])])])]),t._v(" "),a("div",{staticClass:"modal fade",attrs:{id:t.errorid,tabindex:"-1",role:"dialog"}},[a("div",{staticClass:"modal-dialog",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[a("div",{staticClass:"modal-header"},[a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"},on:{click:t.confirmCloseAction}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("×")])]),t._v(" "),a("h4",{staticClass:"modal-title"},[t._v(t._s(t.errorTitle))])]),t._v(" "),a("div",{staticClass:"modal-body"},[a("p",[t._v(t._s(t.errorBody))])]),t._v(" "),t._m(0)])])])],2)},[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}},[this._v("OK")])])}],!1,null,null,null));at.options.__file="Popup.vue";var it={name:"app",components:{PropertiesList:K,ValuesList:tt,Popup:at.exports},data:function(){return{selected:null}},methods:{onSelect:function(t){this.selected=t}}},nt=(a(352),Object(W.a)(it,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("popup",{staticClass:"container-fluid",attrs:{errorid:"error_dialog",confirmid:"confirm_dialog"}},[a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("properties-list",{staticClass:"form-control",on:{select:t.onSelect}})],1)]),t._v(" "),a("div",{staticClass:"row"},[a("div",{staticClass:"col-md-6"},[a("values-list",{attrs:{property:t.selected}})],1)])])},[],!1,null,"e6cb73d0",null));nt.options.__file="App.vue";var st=nt.exports;a(354);new o.a({el:"#properties_app",store:M,components:{App:st}})},91:function(t,e,a){},92:function(t,e,a){},93:function(t,e,a){},94:function(t,e,a){},95:function(t,e,a){}},[[559,5,6,0]]]);
//# sourceMappingURL=properties.js.map